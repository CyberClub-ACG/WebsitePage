<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="" name="description">
    <meta content="Alexandros Kourtis" name="author">

    <link href="../img/other/cyberweb%20logo.png" rel="shortcut icon" type="image/jpg"/>
    <title>CyberWeb Dashboard</title>
    <link href="https://getbootstrap.com/docs/5.0/examples/dashboard/" rel="canonical">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" rel="stylesheet">
    <link crossorigin="anonymous"
          href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.0.1/css/bootstrap-grid.min.css"
          integrity="sha512-Aa+z1qgIG+Hv4H2W3EMl3btnnwTQRA47ZiSecYSkWavHUkBF2aPOIIvlvjLCsjapW1IfsGrEO3FU693ReouVTA=="
          referrerpolicy="no-referrer" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">
    <meta content="#7952b3" name="theme-color">

    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">
    <meta content="#0275d8" name="theme-color">

    <link href="../css/custom.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <link href="../css/stylemembers.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        #myspinner {
            visibility: hidden;
        }

        .modal .btn {
            color: white !important;
        }

        .toast {
            background: #0275d8 !important;
            z-index: 9999999999999 !important;
        }

        i {
            color: #212529 !important;
        }

        .btn {
            border: 1px solid #212529 !important;
        }

        footer {
            position: absolute;
            z-index: 88888 !important;
            width: 100%;
        }

        .form-signin {
            width: 100%;
            max-width: 330px;
            padding: 15px;
            margin: auto;
        }

        .form-signin .checkbox {
            font-weight: 400;
        }

        .form-signin .form-floating:focus-within {
            z-index: 2;
        }

        .form-signin input[type="email"] {
            margin-bottom: -1px;
            border-bottom-right-radius: 0;
            border-bottom-left-radius: 0;
        }

        .form-signin input[type="password"] {
            margin-bottom: 10px;
            border-top-left-radius: 0;
            border-top-right-radius: 0;
        }

        html, body {
            background-color: #202020;
        }
    </style>
</head>
<body>

<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 w-100 text-center" href="./login.html">Cyber<span
            style="color: #0d6efd"><b>Web</b></span> Dashboard</a>
</header>

<div class="container" style="justify-content: center; align-items: center; display: flex; min-height: 65vh;">
    <main class="form-signin" style="text-align: center">
        <img alt="" src="../img/other/cyberweb%20logo.png" style="margin: auto; width: 100px; height: 100px">
        <h4 class="m-3 text-white"><b>Login</b></h4>

        <form id="myform">
            <div class="form-floating">
                <input class="form-control" id="floatingPassword" placeholder="Password" type="password">
                <label for="floatingPassword">Enter your CyberWeb password</label>
            </div>

            <button class="w-100 btn btn-lg btn-primary" id="signinbtn" type="submit">Sign in</button>
        </form>
        <div class="mt-5 text-white" id="spinnerwrapper">
            <div class="spinner-border " id="myspinner" role="status" style="margin: 20px auto; ">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </main>
</div>

<div aria-atomic="true" aria-live="assertive"
     class="position-fixed toast align-items-center bottom-0 start-50 translate-middle-x text-white bg-primary border-0"
     id="toast" role="alert" style="margin-bottom: 20px">
    <div class="d-flex">
        <div class="toast-body">
        </div>
        <button aria-label="Close" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"
                type="button"></button>
    </div>
</div>
<script crossorigin="anonymous"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        referrerpolicy="no-referrer"
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
<script crossorigin="anonymous"
        integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE"
        src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"></script>
<script>
    localStorage.clear();

    function enableSignIn() {
        document.getElementById("signinbtn").disabled = false;
        makeBtnBlue("signinbtn");
    }

    function disableSignIn() {
        document.getElementById("signinbtn").disabled = true;
        makeBtnGray("signinbtn");
    }

    function makeBtnBlue(id) {
        changeClass(id, "btn-primary", "btn-secondary");
    }

    function makeBtnGray(id) {
        changeClass(id, "btn-secondary", "btn-primary");
    }

    function changeClass(id, newclassname, oldclassname) {
        const elm = document.getElementById(id);
        elm.classList.add(newclassname);
        elm.classList.remove(oldclassname);
    }

    function showLoading() {
        document.getElementById("myspinner").style.visibility = "visible";
    }

    function hideLoading() {
        document.getElementById("myspinner").style.visibility = "hidden";
    }

    $("#myform").submit(async function (event) {
        event.preventDefault();
        showLoading();
        disableSignIn();

        await fetch("https://cyberweb-backend.herokuapp.com/user/login", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({password: document.getElementById("floatingPassword").value}),
        })
            .then(res => res.json())
            .then(data => {
                showToast("Successful login");
                localStorage.setItem("secret", data.code);
                window.location.href = "members.html";
            })
            .catch((error) => {
                showToast("Could not log in");
                console.dir(error);
            });
        enableSignIn();
        hideLoading();
    });

    function showToast(text) {
        const options = {
            animation: true,
            autohide: true,
            delay: 2000
        }

        const toastEl = document.getElementById("toast");
        toastEl.getElementsByClassName("toast-body")[0].innerText = text;
        new bootstrap.Toast(toastEl, options).show();
    }
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-117Y4FD2GM"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-117Y4FD2GM');
</script>
</body>
</html>
